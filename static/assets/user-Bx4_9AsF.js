import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{F as t,G as n,H as r,I as i,J as a,K as o,M as s,N as c,O as l,P as u,R as d,U as f,W as p,_ as ee,b as te,c as m,f as ne,i as h,j as re,k as g,s as _,u as ie,v,x as y,z as b}from"./vue-HfZDSVjf.js";import"./axios-ChWArd3X.js";import{c as x,i as S,n as C,o as w,r as T,t as E}from"./index-CuDLuHmr.js";var D={class:`user-container`},O={class:`card-header`},k={class:`action-bar`},A={class:`dialog-footer`},j={class:`dialog-footer`},M=x(u({__name:`index`,setup(e){let u=n([]),x=n(!1),M=n(0),N=n(1),P=n(10),F=e=>{if(!e)return`N/A`;let t=new Date(e);return isNaN(t.getTime())?`N/A`:`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,`0`)}-${String(t.getDate()).padStart(2,`0`)} ${String(t.getHours()).padStart(2,`0`)}:${String(t.getMinutes()).padStart(2,`0`)}:${String(t.getSeconds()).padStart(2,`0`)}`},I=h(),L=n({page:N.value,size:P.value,username:``,name:``}),R=p({username:``,password:``,name:``,status:!0,description:``}),z=n(!1),B=n(!1),V=()=>R.username?R.username.length<3||R.username.length>20?(m.warning(`用户名长度应在3-20个字符之间`),!1):R.name?R.name.length<2||R.name.length>20?(m.warning(`昵称长度应在2-20个字符之间`),!1):R.password?R.password.length<6?(m.warning(`密码长度不能少于6个字符`),!1):!0:(m.warning(`请输入密码`),!1):(m.warning(`请输入昵称`),!1):(m.warning(`请输入用户名`),!1),H=()=>{Object.assign(R,{username:``,password:``,name:``,status:!0,description:``})},U=async()=>{if(V()){z.value=!0;try{await E(R),m.success(`用户创建成功`),B.value=!1,Q(),H()}catch(e){m.error(`创建用户失败`),console.error(`Create user error:`,e)}finally{z.value=!1}}},W=()=>{B.value=!1,H()},G=p({username:``,name:``,status:!0,description:``,password:``}),K=n(!1),q=n(!1),J=n(!1),Y=n(0),ae=async e=>{q.value=!0;try{let t=(await T(e)).data;G.username=t.username,G.name=t.name,G.status=t.status,G.description=t.description||``,G.password=``,Y.value=e}catch(e){m.error(`加载用户数据失败`),console.error(`Load user error:`,e)}finally{q.value=!1}},oe=()=>G.username?G.username.length<3||G.username.length>20?(m.warning(`用户名长度应在3-20个字符之间`),!1):G.name?G.name.length<2||G.name.length>20?(m.warning(`昵称长度应在2-20个字符之间`),!1):G.password&&G.password.length<6?(m.warning(`密码长度不能少于6个字符`),!1):!0:(m.warning(`请输入昵称`),!1):(m.warning(`请输入用户名`),!1),X=()=>{Object.assign(G,{username:``,name:``,status:!0,description:``,password:``}),Y.value=0},se=async()=>{if(oe()){K.value=!0;try{await w(Y.value,G),m.success(`用户更新成功`),J.value=!1,Q(),X()}catch(e){m.error(`更新用户失败`),console.error(`Update user error:`,e)}finally{K.value=!1}}},ce=()=>{J.value=!1,X()},Z=async e=>{I.push(`/users/${e.id}`)},Q=async()=>{x.value=!0;try{L.value.page=N.value,L.value.size=P.value;let e=await S(L.value);u.value=e.data.items,M.value=e.data.total}catch(e){m.error(`加载用户列表失败`),console.error(`加载用户列表失败:`,e)}finally{x.value=!1}},$=()=>{Q()},le=()=>{N.value=1,Q()},ue=()=>{N.value=1,Object.assign(L.value,{username:``,name:``}),Q()},de=()=>{B.value=!0},fe=async e=>{await ae(e.id),J.value=!0},pe=async e=>{try{await _.confirm(`确定要删除用户 ${e.username} 吗？`,`确认删除`,{confirmButtonText:`确定`,cancelButtonText:`取消`,type:`warning`}),await C(e.id),m.success(`删除成功`),Q()}catch(e){e!==`cancel`&&(m.error(`删除失败`),console.error(`Delete user error:`,e))}};return t(()=>{Q()}),(e,t)=>{let n=d(`el-input`),p=d(`el-icon`),m=d(`el-button`),h=d(`el-form`),_=d(`el-table-column`),S=d(`el-tag`),C=d(`el-table`),w=d(`el-pagination`),T=d(`el-card`),E=d(`el-form-item`),I=d(`el-switch`),V=d(`el-dialog`),H=b(`loading`);return i(),re(`div`,D,[c(T,{class:`user-list-card`,shadow:`hover`,border:`true`,title:`用户列表`},{header:r(()=>[l(`div`,O,[c(h,{class:`search-bar`,model:L.value,inline:``},{default:r(()=>[c(n,{modelValue:L.value.username,"onUpdate:modelValue":t[0]||=e=>L.value.username=e,placeholder:`用户名`,style:{width:`200px`,"margin-right":`10px`}},null,8,[`modelValue`]),c(n,{modelValue:L.value.name,"onUpdate:modelValue":t[1]||=e=>L.value.name=e,placeholder:`姓名`,style:{width:`200px`,"margin-right":`10px`}},null,8,[`modelValue`]),c(m,{type:`primary`,onClick:le},{default:r(()=>[c(p,null,{default:r(()=>[c(o(te))]),_:1}),t[16]||=s(` 搜索 `,-1)]),_:1}),c(m,{onClick:ue},{default:r(()=>[c(p,null,{default:r(()=>[c(o(v))]),_:1}),t[17]||=s(` 重置 `,-1)]),_:1})]),_:1},8,[`model`]),l(`div`,k,[c(m,{type:`primary`,onClick:de},{default:r(()=>[c(p,null,{default:r(()=>[c(o(ee))]),_:1}),t[18]||=s(` 创建用户 `,-1)]),_:1})])])]),footer:r(()=>[c(w,{"current-page":N.value,"onUpdate:currentPage":t[2]||=e=>N.value=e,"page-size":P.value,"onUpdate:pageSize":t[3]||=e=>P.value=e,"page-sizes":[5,10,20,50],layout:`total, sizes, prev, pager, next, jumper`,total:M.value,onSizeChange:$,onCurrentChange:$},null,8,[`current-page`,`page-size`,`total`])]),default:r(()=>[f((i(),g(C,{data:u.value,stripe:``,border:``,style:{width:`100%`},"row-style":{transition:`background-color 0.2s`}},{default:r(()=>[c(_,{prop:`id`,label:`ID`,width:`80`}),c(_,{prop:`username`,label:`用户名`}),c(_,{prop:`name`,label:`昵称`}),c(_,{prop:`status`,label:`状态`,width:`120`},{default:r(e=>[e.row.status?(i(),g(S,{key:0,type:`success`},{default:r(()=>[...t[19]||=[s(` 激活 `,-1)]]),_:1})):(i(),g(S,{key:1,type:`danger`},{default:r(()=>[...t[20]||=[s(` 未激活 `,-1)]]),_:1}))]),_:1}),c(_,{prop:`created_time`,label:`创建时间`,width:`180`},{default:r(e=>[s(a(F(e.row.created_time)),1)]),_:1}),c(_,{prop:`updated_time`,label:`更新时间`,width:`180`},{default:r(e=>[s(a(F(e.row.updated_time)),1)]),_:1}),c(_,{label:`操作`,width:`280`},{default:r(e=>[c(m,{size:`small`,onClick:t=>Z(e.row),type:`info`},{default:r(()=>[c(p,null,{default:r(()=>[c(o(y))]),_:1}),t[21]||=s(` 详情 `,-1)]),_:1},8,[`onClick`]),c(m,{type:`primary`,size:`small`,onClick:t=>fe(e.row)},{default:r(()=>[c(p,null,{default:r(()=>[c(o(ne))]),_:1}),t[22]||=s(` 编辑 `,-1)]),_:1},8,[`onClick`]),c(m,{type:`danger`,size:`small`,onClick:t=>pe(e.row)},{default:r(()=>[c(p,null,{default:r(()=>[c(o(ie))]),_:1}),t[23]||=s(` 删除 `,-1)]),_:1},8,[`onClick`])]),_:1})]),_:1},8,[`data`])),[[H,x.value]])]),_:1}),c(V,{title:`创建用户`,modelValue:B.value,"onUpdate:modelValue":t[9]||=e=>B.value=e},{footer:r(()=>[l(`div`,A,[c(m,{onClick:W},{default:r(()=>[...t[24]||=[s(`取消`,-1)]]),_:1}),c(m,{type:`primary`,onClick:U,loading:z.value},{default:r(()=>[...t[25]||=[s(`确定`,-1)]]),_:1},8,[`loading`])])]),default:r(()=>[f((i(),g(h,{model:R,"label-width":`100px`,class:`user-form`},{default:r(()=>[c(E,{label:`用户名`},{default:r(()=>[c(n,{modelValue:R.username,"onUpdate:modelValue":t[4]||=e=>R.username=e,placeholder:`请输入用户名`},null,8,[`modelValue`])]),_:1}),c(E,{label:`昵称`},{default:r(()=>[c(n,{modelValue:R.name,"onUpdate:modelValue":t[5]||=e=>R.name=e,placeholder:`请输入昵称`},null,8,[`modelValue`])]),_:1}),c(E,{label:`密码`},{default:r(()=>[c(n,{modelValue:R.password,"onUpdate:modelValue":t[6]||=e=>R.password=e,type:`password`,placeholder:`请输入密码`},null,8,[`modelValue`])]),_:1}),c(E,{label:`是否激活`},{default:r(()=>[c(I,{modelValue:R.status,"onUpdate:modelValue":t[7]||=e=>R.status=e},null,8,[`modelValue`])]),_:1}),c(E,{label:`备注`},{default:r(()=>[c(n,{modelValue:R.description,"onUpdate:modelValue":t[8]||=e=>R.description=e,type:`textarea`,placeholder:`请输入备注`,rows:3},null,8,[`modelValue`])]),_:1})]),_:1},8,[`model`])),[[H,z.value]])]),_:1},8,[`modelValue`]),c(V,{title:`编辑用户`,modelValue:J.value,"onUpdate:modelValue":t[15]||=e=>J.value=e},{footer:r(()=>[l(`div`,j,[c(m,{onClick:ce},{default:r(()=>[...t[26]||=[s(`取消`,-1)]]),_:1}),c(m,{type:`primary`,onClick:se,loading:K.value},{default:r(()=>[...t[27]||=[s(`确定`,-1)]]),_:1},8,[`loading`])])]),default:r(()=>[f((i(),g(h,{model:G,"label-width":`100px`,class:`user-form`},{default:r(()=>[c(E,{label:`用户名`},{default:r(()=>[c(n,{modelValue:G.username,"onUpdate:modelValue":t[10]||=e=>G.username=e,placeholder:`请输入用户名`},null,8,[`modelValue`])]),_:1}),c(E,{label:`昵称`},{default:r(()=>[c(n,{modelValue:G.name,"onUpdate:modelValue":t[11]||=e=>G.name=e,placeholder:`请输入昵称`},null,8,[`modelValue`])]),_:1}),c(E,{label:`密码`},{default:r(()=>[c(n,{modelValue:G.password,"onUpdate:modelValue":t[12]||=e=>G.password=e,type:`password`,placeholder:`请输入密码`},null,8,[`modelValue`])]),_:1}),c(E,{label:`是否激活`},{default:r(()=>[c(I,{modelValue:G.status,"onUpdate:modelValue":t[13]||=e=>G.status=e},null,8,[`modelValue`])]),_:1}),c(E,{label:`备注`},{default:r(()=>[c(n,{modelValue:G.description,"onUpdate:modelValue":t[14]||=e=>G.description=e,type:`textarea`,placeholder:`请输入备注`,rows:3},null,8,[`modelValue`])]),_:1})]),_:1},8,[`model`])),[[H,q.value]])]),_:1},8,[`modelValue`])])}}}),[[`__scopeId`,`data-v-7beb2202`]]);export{M as default};