import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{A as t,B as ee,F as n,G as r,I as i,K as a,L as o,M as te,N as s,P as c,S as ne,U as l,W as u,Y as d,a as f,c as p,d as m,k as h,l as g,p as re,q as _,v as ie,x as v,y,z as b}from"./vue-Cb9WPcpC.js";import"./axios-ChWArd3X.js";import{c as x,i as S,n as C,o as w,r as T,t as E}from"./index-DhRDvLz_.js";var D={class:`user-container`},O={class:`card-header`},k={class:`action-bar`},A={class:`dialog-footer`},j={class:`dialog-footer`},M=x(n({__name:`index`,setup(e){let n=a([]),x=a(!1),M=a(0),N=a(1),P=a(10),F=e=>{if(!e)return`N/A`;let t=new Date(e);return isNaN(t.getTime())?`N/A`:`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,`0`)}-${String(t.getDate()).padStart(2,`0`)} ${String(t.getHours()).padStart(2,`0`)}:${String(t.getMinutes()).padStart(2,`0`)}:${String(t.getSeconds()).padStart(2,`0`)}`},I=f(),L=a({page:N.value,size:P.value,name:``}),R=r({username:``,password:``,name:``,status:!0,description:``}),z=a(!1),B=a(!1),V=()=>R.username?R.username.length<3||R.username.length>20?(g.warning(`用户名长度应在3-20个字符之间`),!1):R.name?R.name.length<2||R.name.length>20?(g.warning(`昵称长度应在2-20个字符之间`),!1):R.password?R.password.length<6?(g.warning(`密码长度不能少于6个字符`),!1):!0:(g.warning(`请输入密码`),!1):(g.warning(`请输入昵称`),!1):(g.warning(`请输入用户名`),!1),H=()=>{Object.assign(R,{username:``,password:``,name:``,status:!0,description:``})},U=async()=>{if(V()){z.value=!0;try{await E(R),g.success(`用户创建成功`),B.value=!1,Q(),H()}catch(e){g.error(`创建用户失败`),console.error(`创建用户失败:`,e)}finally{z.value=!1}}},W=()=>{B.value=!1,H()},G=r({username:``,name:``,status:!0,description:``,password:``}),K=a(!1),q=a(!1),J=a(!1),Y=a(0),ae=async e=>{q.value=!0;try{let t=(await T(e)).data;G.username=t.username,G.name=t.name,G.status=t.status,G.description=t.description||``,G.password=``,Y.value=e}catch(e){g.error(`加载用户数据失败`),console.error(`Load user error:`,e)}finally{q.value=!1}},oe=()=>G.username?G.username.length<3||G.username.length>20?(g.warning(`用户名长度应在3-20个字符之间`),!1):G.name?G.name.length<2||G.name.length>20?(g.warning(`昵称长度应在2-20个字符之间`),!1):G.password&&G.password.length<6?(g.warning(`密码长度不能少于6个字符`),!1):!0:(g.warning(`请输入昵称`),!1):(g.warning(`请输入用户名`),!1),X=()=>{Object.assign(G,{username:``,name:``,status:!0,description:``,password:``}),Y.value=0},se=async()=>{if(oe()){K.value=!0;try{await w(Y.value,G),g.success(`用户更新成功`),J.value=!1,Q(),X()}catch(e){g.error(`更新用户失败`),console.error(`Update user error:`,e)}finally{K.value=!1}}},ce=()=>{J.value=!1,X()},Z=async e=>{I.push(`/users/${e.id}`)},Q=async()=>{x.value=!0;try{L.value.page=N.value,L.value.size=P.value;let e=await S(L.value);n.value=e.data.items,M.value=e.data.total}catch(e){g.error(`加载用户列表失败`),console.error(`加载用户列表失败:`,e)}finally{x.value=!1}},$=()=>{Q()},le=()=>{N.value=1,Q()},ue=()=>{N.value=1,Object.assign(L.value,{username:``,name:``}),Q()},de=()=>{B.value=!0},fe=async e=>{await ae(e.id),J.value=!0},pe=async e=>{try{await p.confirm(`确定要删除用户 ${e.username} 吗？`,`确认删除`,{confirmButtonText:`确定`,cancelButtonText:`取消`,type:`warning`}),await C(e.id),g.success(`删除成功`),Q()}catch(e){e!==`cancel`&&(g.error(`删除失败`),console.error(`Delete user error:`,e))}};return i(()=>{Q()}),(e,r)=>{let i=b(`el-input`),a=b(`el-icon`),f=b(`el-button`),p=b(`el-form`),g=b(`el-table-column`),S=b(`el-tag`),C=b(`el-table`),w=b(`el-pagination`),T=b(`el-card`),E=b(`el-form-item`),I=b(`el-switch`),V=b(`el-dialog`),H=ee(`loading`);return o(),te(`div`,D,[c(T,{class:`user-list-card`,shadow:`hover`,border:`true`,title:`用户列表`},{header:l(()=>[h(`div`,O,[c(p,{class:`search-bar`,model:L.value,inline:``},{default:l(()=>[c(i,{modelValue:L.value.name,"onUpdate:modelValue":r[0]||=e=>L.value.name=e,placeholder:`姓名`,style:{width:`200px`,"margin-right":`10px`}},null,8,[`modelValue`]),c(f,{type:`primary`,onClick:le},{default:l(()=>[c(a,null,{default:l(()=>[c(_(v))]),_:1}),r[15]||=s(` 搜索 `,-1)]),_:1}),c(f,{onClick:ue},{default:l(()=>[c(a,null,{default:l(()=>[c(_(y))]),_:1}),r[16]||=s(` 重置 `,-1)]),_:1})]),_:1},8,[`model`]),h(`div`,k,[c(f,{type:`primary`,onClick:de},{default:l(()=>[c(a,null,{default:l(()=>[c(_(ie))]),_:1}),r[17]||=s(` 创建用户 `,-1)]),_:1})])])]),footer:l(()=>[c(w,{"current-page":N.value,"onUpdate:currentPage":r[1]||=e=>N.value=e,"page-size":P.value,"onUpdate:pageSize":r[2]||=e=>P.value=e,"page-sizes":[5,10,20,50],layout:`total, sizes, prev, pager, next, jumper`,total:M.value,onSizeChange:$,onCurrentChange:$},null,8,[`current-page`,`page-size`,`total`])]),default:l(()=>[u((o(),t(C,{data:n.value,stripe:``,border:``,style:{width:`100%`},"row-style":{transition:`background-color 0.2s`}},{default:l(()=>[c(g,{prop:`id`,label:`ID`,width:`80`}),c(g,{prop:`username`,label:`用户名`}),c(g,{prop:`name`,label:`昵称`}),c(g,{prop:`status`,label:`状态`,width:`120`},{default:l(e=>[e.row.status?(o(),t(S,{key:0,type:`success`},{default:l(()=>[...r[18]||=[s(` 激活 `,-1)]]),_:1})):(o(),t(S,{key:1,type:`danger`},{default:l(()=>[...r[19]||=[s(` 未激活 `,-1)]]),_:1}))]),_:1}),c(g,{prop:`created_time`,label:`创建时间`,width:`180`},{default:l(e=>[s(d(F(e.row.created_time)),1)]),_:1}),c(g,{prop:`updated_time`,label:`更新时间`,width:`180`},{default:l(e=>[s(d(F(e.row.updated_time)),1)]),_:1}),c(g,{label:`操作`,width:`280`},{default:l(e=>[c(f,{size:`small`,onClick:t=>Z(e.row),type:`info`},{default:l(()=>[c(a,null,{default:l(()=>[c(_(ne))]),_:1}),r[20]||=s(` 详情 `,-1)]),_:1},8,[`onClick`]),c(f,{type:`primary`,size:`small`,onClick:t=>fe(e.row)},{default:l(()=>[c(a,null,{default:l(()=>[c(_(re))]),_:1}),r[21]||=s(` 编辑 `,-1)]),_:1},8,[`onClick`]),c(f,{type:`danger`,size:`small`,onClick:t=>pe(e.row)},{default:l(()=>[c(a,null,{default:l(()=>[c(_(m))]),_:1}),r[22]||=s(` 删除 `,-1)]),_:1},8,[`onClick`])]),_:1})]),_:1},8,[`data`])),[[H,x.value]])]),_:1}),c(V,{title:`创建用户`,modelValue:B.value,"onUpdate:modelValue":r[8]||=e=>B.value=e},{footer:l(()=>[h(`div`,A,[c(f,{onClick:W},{default:l(()=>[...r[23]||=[s(`取消`,-1)]]),_:1}),c(f,{type:`primary`,onClick:U,loading:z.value},{default:l(()=>[...r[24]||=[s(`确定`,-1)]]),_:1},8,[`loading`])])]),default:l(()=>[u((o(),t(p,{model:R,"label-width":`100px`,class:`user-form`},{default:l(()=>[c(E,{label:`用户名`},{default:l(()=>[c(i,{modelValue:R.username,"onUpdate:modelValue":r[3]||=e=>R.username=e,placeholder:`请输入用户名`},null,8,[`modelValue`])]),_:1}),c(E,{label:`昵称`},{default:l(()=>[c(i,{modelValue:R.name,"onUpdate:modelValue":r[4]||=e=>R.name=e,placeholder:`请输入昵称`},null,8,[`modelValue`])]),_:1}),c(E,{label:`密码`},{default:l(()=>[c(i,{modelValue:R.password,"onUpdate:modelValue":r[5]||=e=>R.password=e,type:`password`,placeholder:`请输入密码`},null,8,[`modelValue`])]),_:1}),c(E,{label:`是否激活`},{default:l(()=>[c(I,{modelValue:R.status,"onUpdate:modelValue":r[6]||=e=>R.status=e},null,8,[`modelValue`])]),_:1}),c(E,{label:`备注`},{default:l(()=>[c(i,{modelValue:R.description,"onUpdate:modelValue":r[7]||=e=>R.description=e,type:`textarea`,placeholder:`请输入备注`,rows:3},null,8,[`modelValue`])]),_:1})]),_:1},8,[`model`])),[[H,z.value]])]),_:1},8,[`modelValue`]),c(V,{title:`编辑用户`,modelValue:J.value,"onUpdate:modelValue":r[14]||=e=>J.value=e},{footer:l(()=>[h(`div`,j,[c(f,{onClick:ce},{default:l(()=>[...r[25]||=[s(`取消`,-1)]]),_:1}),c(f,{type:`primary`,onClick:se,loading:K.value},{default:l(()=>[...r[26]||=[s(`确定`,-1)]]),_:1},8,[`loading`])])]),default:l(()=>[u((o(),t(p,{model:G,"label-width":`100px`,class:`user-form`},{default:l(()=>[c(E,{label:`用户名`},{default:l(()=>[c(i,{modelValue:G.username,"onUpdate:modelValue":r[9]||=e=>G.username=e,placeholder:`请输入用户名`},null,8,[`modelValue`])]),_:1}),c(E,{label:`昵称`},{default:l(()=>[c(i,{modelValue:G.name,"onUpdate:modelValue":r[10]||=e=>G.name=e,placeholder:`请输入昵称`},null,8,[`modelValue`])]),_:1}),c(E,{label:`密码`},{default:l(()=>[c(i,{modelValue:G.password,"onUpdate:modelValue":r[11]||=e=>G.password=e,type:`password`,placeholder:`请输入密码`},null,8,[`modelValue`])]),_:1}),c(E,{label:`是否激活`},{default:l(()=>[c(I,{modelValue:G.status,"onUpdate:modelValue":r[12]||=e=>G.status=e},null,8,[`modelValue`])]),_:1}),c(E,{label:`备注`},{default:l(()=>[c(i,{modelValue:G.description,"onUpdate:modelValue":r[13]||=e=>G.description=e,type:`textarea`,placeholder:`请输入备注`,rows:3},null,8,[`modelValue`])]),_:1})]),_:1},8,[`model`])),[[H,q.value]])]),_:1},8,[`modelValue`])])}}}),[[`__scopeId`,`data-v-5e3944eb`]]);export{M as default};